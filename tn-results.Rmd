---
title: "Project A"
author: "Carmen Canedo"
date: "May 25, 2020"
output:
  pdf_document: default
  html_notebook: default
editor_options:
  chunk_output_type: inline
---

# Intoduction

# Loading libraries
```{r, message=FALSE}
library(tidyverse)
library(urbnmapr)
library(RColorBrewer)
```

# Load in data
```{r}
# Importing data from all states
county_results <- read.csv("countypres_2000-2016.csv")
```

# Cleaning data

## Filtering for Tennessee
```{r}
# Narrowing to Tennessee only
county_results <- county_results %>% 
  filter(state == "Tennessee") %>% 
  select(-state_po, -office)
```

### Exporting .csv of all TN election data from 2000-2016
I am leaving this commented out so that it does not produce a new .csv very time.
```{r}
# Writing .csv of full Tennessee data (for lab submission only)
# write_csv(county_results, "Tennessee.csv")
```

## Selecting necessary columns
I added FIPS so that I can merge the data onto the choropleth map later in the project.
```{r}
county_results <- county_results %>% 
  select(year, county, party, candidate, candidatevotes, totalvotes, FIPS)
```

## Renaming columns
I am using the Tidy Data format. Selecting one party so there are no NA values?
```{r}
county_results <- county_results %>% 
  rename(candidate_votes = candidatevotes) %>% 
  rename(total_votes = totalvotes) %>% 
  rename(county_fips = FIPS)

# Converting county_fips to characters
county_results$county_fips <- as.character(county_results$county_fips)
```

## Filtering to just one election year and political party
2008? Because Obama?
```{r}
county_results_08 <- county_results %>% 
  filter(year == 2008) %>% 
  filter(party == "democrat")
```

## Calculating percent of vote
```{r}
county_results_08 <- county_results_08 %>% 
  mutate(percent_vote = 100 * (candidate_votes / total_votes))
```

### Exporting .csv of clean data
This .csv file includes data for Barack Obama's 2008 election results for all counties in Tennessee.
```{r}
# Writing .csv (for lab submission only)
# write_csv(county_results_08, "tn-2008-democrats.csv")
```

# Data visualization
Talk about different visualization techniques.

## Choropleth Map
I am using the `urbanmapr` package and referencing their vignette which can be accessed *[here](https://github.com/UrbanInstitute/urbnmapr/blob/master/vignettes/introducing-urbnmapr.Rmd)*.
```{r}
# Filtering counties data set to only Tennessee
tn_counties <- counties %>% 
  filter(state_name == "Tennessee")

# Creating map
tn_counties %>% 
  ggplot(aes(long, lat, group = group)) +
  geom_polygon(fill = "grey", color = "#ffffff", size = 0.25) +
  coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
  theme_void()
```

### Merging data on to map
Using `left_join()` to combine data frames
```{r, warning=FALSE}
# Left join
dem_results_08 <- left_join(county_results_08, tn_counties, by = "county_fips")

# Adding election results to map
dem_results_08 <-  dem_results_08 %>% 
  ggplot(aes(long, lat, group = group, fill = percent_vote)) +
  geom_polygon(color = "#ffffff", size = 0.25) +
  coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
  theme_void()

# Adding color to map
dem_results_08 <- dem_results_08 +
  scale_fill_gradient(low = "#9ECAE1", high = "#2171B5") +
  theme(legend.position = "right",
        legend.direction = "vertical",
        legend.title = element_text(family = "Times New Roman", face = "bold", size = 11)) +
  labs(fill = "Percent of Votes \nReceived")

# Adding titles
dem_results_08 <- dem_results_08 +
  labs(title = "Percentage of Votes Received in Tennessee \n for Barack Obama in 2008 Presidential Election",
       subtitle = "Carmen Canedo \n",
       caption = "\nSource: MIT Election Data & Science Lab | STAT 202, Summer 2020") +
  theme(plot.title = element_text(family = "Times New Roman", face = "bold"),
        plot.subtitle = element_text(family = "Times New Roman", face = "italic"),
        plot.caption = element_text(family = "Times New Roman", face = "plain"))

dem_results_08
```

## Boxplot
of percent vote

GO BACK TO EARLIER DATA FRAME `county_results_08`
```{r}

```

## Histogram
of percent vote
```{r}
# Creates base for histogram
hist_results <- county_results_08 %>% 
  ggplot(aes(x = percent_vote, y = ..density..)) +
  geom_histogram(binwidth = 2,
                 color = "black",
                 fill = "white") +
  theme_minimal()

# Adds median line
hist_results <- hist_results +
  geom_vline(aes(xintercept = median(percent_vote)),
             color = "red",
             linetype = "dashed")

# Changing the look of the density
hist_results <- hist_results +
  geom_density(alpha = 0.75, fill = "light blue")

# Adding text
hist_results <- hist_results +
  labs(x = "Percent of Votes Received",
       y = "Density",
       title = "Percent of Votes Cast for Barack Obama \nby Tennesse Democrats in 2008 Presidential Election",
       subtitle = "Carmen Canedo \n",
       caption = "\nSource: MIT Election Data & Science Lab | STAT 202, Summer 2020") +
  theme(plot.title = element_text(family = "Times New Roman", face = "bold"),
        plot.subtitle = element_text(family = "Times New Roman", face = "italic"),
        plot.caption = element_text(family = "Times New Roman", face = "plain"))

hist_results
```

## Scatter Plot
x - percent_vote
y - total_vote

# Conclusion

